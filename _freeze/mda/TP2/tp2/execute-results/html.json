{
  "hash": "8d083f13e429e1857121d4dfc28523a8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: 'Principal Component Analysis'\n---\n\n\nChargement de l'environnement\n\n# Introduction\n\nDans cette séance de travail pratique, nous avons comparé les résultats de méthodes non supervisées appliquées à un jeu de données correspondant à des poches de protéines. Le but étant de déterminer le druggabilité de ces poches en fonction de leur propriétés.\n\n## Présentation des données\n\nChargement des données\n\n::: {.cell}\n\n```{.r .cell-code}\nload(\"../data/X.Rdata\")\nload(\"../data/Y.Rdata\")\n```\n:::\n\n\nNotre jeu de données contient 109 poches, chacune décrite par 18 descripteurs. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(FactoMineR)\n\nres.pca <- PCA(X, scale.unit = TRUE, graph = TRUE, ncp = 5)\n\n# Visualisation des descripteurs\nbarplot(res.pca$eig[, 1:3], beside = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Etude de l'espace des variables\nplot(res.pca, choix = 'var')\n```\n\n::: {.cell-output-display}\n![](tp2_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Etude de l'espace des individus\nplot(res.pca, choix = 'ind', label=\"none\")\n```\n\n::: {.cell-output-display}\n![](tp2_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n\n\n\n\n## Comparaisons des données en fonction de la mise à l'échelle\n\nNous observons que pour les données mises à l'échelle nous avons plusieurs valeurs propres des importances décroissante. Si nous observons le barplot des données non mises à l'échelle, nous n'avons qu'une seule valeur propre dont la valeur est très élevée. \nSi nous comparons les graphes des variables, nous voyons pour les données mises à l'échelle deux composantes principales expliquant respectivement 25,86% et 18,74% de descripteurs. Pour les données non mises à l'échelle nous voyons une première CP à 99,91%. Cela est dû à l'ordre de grandeur du volume réel qui est bien supérieur à celui des autres descripteurs.\n\nPour travailler sur la suite, nous allons donc utiliser les valeurs mises à l'échelle et nous choissons donc de travailler avec les trois premières composantes principales qui expliquent environ 60% des résultats.\n\n## Etude du graphe des variables\n\nSur ce plan, nous avons 44,6% de variabilité ce qui implique que toute la variance du jeu de données n'est pas expliquée par ces deux vecteurs propres.\nNous voyons qu'il y bien des variables mieux représentées que d'autres, elles correspondent à celles s'éloignant le plus de centre du graphe (ex: C_ATOM, polar, aliphatic)\nLes variables corrélées sont celles situées dans les mêmes régions par rapport à un axe et les anti-corrélées sont celles dans les régions opposées par rapport à un axe.\nLes variables \"indépendantes\" sont celles n'étant pas expliquées par les deux axes. Nous n'avons pas d'information sur elles et ne peuvent donc pas être comparées aux autres.\nNous avons donc un premier axe qui caractérise la polarité\n\n## Etude du graphe des individus\n\nIl y bien des outliers, points isolés du reste.\nPour les proches au centre de la projection sont celles étant mal expliquées par nos deux composantes principales.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(res.pca, choix = 'ind', select = poches, axes = c(3,4))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: ggrepel: 3 unlabeled data points (too many overlaps). Consider\nincreasing max.overlaps\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](tp2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\ncorrplot 0.92 loaded\n```\n\n\n:::\n\n```{.r .cell-code}\ncorrplot(cor(X), tl.cex = 0.7)\n```\n\n::: {.cell-output-display}\n![](tp2_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Biplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(factoextra)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n```\n\n\n:::\n\n```{.r .cell-code}\nfviz_pca_biplot(res.pca, label=\"var\", repel = TRUE)\n```\n\n::: {.cell-output-display}\n![](tp2_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n# Comparation espace de données des deux échantillons\n\n## Réalisation de deux échantillons, train et test set\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain.names <- sample(rownames(X), 2*nrow(X)/3, replace = FALSE)\ntest.names <- rownames(X)[-which(rownames(X) %in% train.names)]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nres.sample <- PCA(X, scale.unit = TRUE, ind.sup = match(test.names, rownames(X)))\nfviz_pca_biplot(res.sample, geom='point')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain.set <- X[train.names,]\ntest.set <- X[test.names,]\n\ntrain.dtf <- cbind(train.set, Y[train.names,])\ntest.dtf <- cbind(test.set, Y[test.names,])\n```\n:::\n\n\n## Réitération du protocole avec les résultats du TP1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# res.cutree <- cutree(x_classif, k=4)\n\n# clust_colors <- c(\"red\", \"blue\", \"green\", \"yellow\")\n\n# fviz_pca_biplot(res.pca, col.ind = res.cutree, label = \"var\", choix = \"ind\")\n```\n:::\n",
    "supporting": [
      "tp2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}